{"version":17,"variables":[{"key":"CVE","type":"query","visible":true,"input":"fetch events\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\"\n  AND event.level==\"ENTITY\"\n// UUsing Dedep will remove duplicate records based on defined fields\n| sort timestamp desc\n| dedup vulnerability.references.cve\n| fields vulnerability.references.cve","multiple":false,"version":1}],"tiles":{"0":{"type":"data","title":"Vulnerability Analysis - Process Groups","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, $CVE)\n| fieldsRename  dt.source_entity = affected_entity.id\n| expand related_entities.hosts.ids\n| join kind:inner, [\n    fetch dt.entity.process_group\n    | fieldsAdd pg.name=entity.name, metadata, listenPorts, tags\n    | expand metadata\n    | filter contains(metadata,\"EXE_PATH\")\n    | parse metadata, \"\"\"\"EXE_PATH:\" LD:path\"\"\"\n    | fields dt.source_entity=id, pg.name, path, listenPorts, tags\n], on:{dt.source_entity}, fields:{pg.name, path, listenPorts, tags}\n| dedup {vulnerability.id, dt.source_entity}\n\n| fields \n    vulnerability.id,\n    CVE=vulnerability.references.cve,\n    davis_assessment.level=vulnerability.davis_assessment.level,\n    event.status,\n    davis_assessment.score=vulnerability.davis_assessment.score,\n    cvss.base=vulnerability.cvss.base_score,\n    description=event.description, \n    process.name=affected_entity.name, \n    pg.name, \n    path,\n    listenPorts, \n    hosts.names=related_entities.hosts.names, \n    vulnerable_component=affected_entity.vulnerable_component.name,\n    technology=vulnerability.technology,\n    stack=vulnerability.stack,\n    remediation=vulnerability.remediation.description,\n    tags,\n    vulnerability.url,\n    vulnerability.external_url,\n    exposure_status=vulnerability.davis_assessment.exposure_status,\n    data_assets_status=vulnerability.davis_assessment.data_assets_status,\n    vulnerable_function_status=vulnerability.davis_assessment.vulnerable_function_status,\n    exploit_status=vulnerability.davis_assessment.exploit_status\n","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"davis_assessment.level","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"=","label":"","value":"LOW"},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"=","label":"","value":"MEDIUM"},{"id":2,"color":{"Default":"var(--dt-colors-charts-status-critical-default, #c4233b)"},"comparator":"=","label":"","value":"CRITICAL"},{"id":3,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"=","label":"","value":"HIGH"}]},{"id":2,"field":"davis_assessment.score","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"≤","label":"","value":3.9},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≤","label":"","value":6.9},{"id":2,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"≤","label":"","value":8.9},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≤","label":"","value":10}]},{"id":3,"field":"cvss.base","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"≤","label":"","value":3.9},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≤","label":"","value":6.9},{"id":2,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"≤","label":"","value":8.9},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≤","label":"","value":10}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["vulnerability.id","davis_assessment.level","event.status","description","process.name","pg.name","path","vulnerable_component","technology","stack","vulnerability.url","vulnerability.external_url","exposure_status","data_assets_status","vulnerable_function_status","exploit_status"],"categoryAxisLabel":"vulnerability.id,davis_assessment.level,event.status,description,process.name,pg.name,path,vulnerable_component,technology,stack,vulnerability.url,vulnerability.external_url,exposure_status,data_assets_status,vulnerable_function_status,exploit_status","valueAxis":["davis_assessment.score","cvss.base"],"valueAxisLabel":"davis_assessment.score,cvss.base","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":[]},"singleValue":{"showLabel":true,"label":"timestamp","prefixIcon":"","recordField":"timestamp","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[["vulnerability.id"]],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"davis_assessment.level\"]":165.453125,"[\"davis_assessment.score\"]":95.6875,"[\"vulnerability.references.cve\"]":278.9453125,"[\"description\"]":315.78125,"[\"hosts.names\"]":557.890625},"columnTypeOverrides":[],"sortBy":{"columnId":"[\"process.name\"]","direction":"descending"}},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["vulnerability.id","davis_assessment.level","event.status","description","process.name","pg.name","path","vulnerable_component","technology","stack","vulnerability.url","vulnerability.external_url","exposure_status","data_assets_status","vulnerable_function_status","exploit_status"],"dataMappings":{"value":"davis_assessment.score"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"davis_assessment.score","rangeAxis":""},{"valueAxis":"cvss.base","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["davis_assessment.level","event.status","description","process.name","pg.name","path","vulnerable_component","technology","stack","vulnerability.url","vulnerability.external_url","exposure_status","data_assets_status","vulnerable_function_status","exploit_status"]},"valueBoundaries":{"min":"auto","max":"auto"},"label":{"showLabel":false,"label":"davis_assessment.score"},"icon":{"showIcon":false,"icon":""},"autoSelectVisualization":false,"recordView":{"fieldsWidth":200.84},"dataMapping":{"value":"davis_assessment.score"}},"querySettings":{"maxResultRecords":5000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":20,"defaultSamplingRatio":10,"enableSampling":false}},"2":{"type":"data","title":"Vulnerability analysis - Host Analysis","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, $CVE)\n| fieldsRename  dt.source_entity = affected_entity.id\n| expand related_entities.hosts.ids\n| dedup {vulnerability.id, dt.source_entity}\n// You can join these records using Dynatrace's InnerJoin\n| join [\nfetch dt.entity.host\n| fieldsAdd ipAddress, entity.name, host_tags=tags, cloudType, macAddresses, state, hypervisorType, lifetime\n], on: { left[related_entities.hosts.ids] == right[id]}, fields: {ipAddress, entity.name, host_tags, cloudType, macAddresses, state, hypervisorType, lifetime} \n\n| fields CVE=vulnerability.references.cve,\n    ipAddress,\n    hosts.names=related_entities.hosts.names,\n    host_tags, cloudType, macAddresses, state, hypervisorType, lifetime,\n    davis_assessment.level=vulnerability.davis_assessment.level,\n    event.status,\n    davis_assessment.score=vulnerability.davis_assessment.score,\n    cvss.base=vulnerability.cvss.base_score,\n    process.name=affected_entity.name, \n\n    vulnerable_component=affected_entity.vulnerable_component.name\n   \n\n","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"davis_assessment.level","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"=","label":"","value":"LOW"},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"=","label":"","value":"MEDIUM"},{"id":2,"color":{"Default":"var(--dt-colors-charts-status-critical-default, #c4233b)"},"comparator":"=","label":"","value":"CRITICAL"},{"id":3,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"=","label":"","value":"HIGH"}]},{"id":2,"field":"davis_assessment.score","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"≤","label":"","value":3.9},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≤","label":"","value":6.9},{"id":2,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"≤","label":"","value":8.9},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≤","label":"","value":10}]},{"id":3,"field":"cvss.base","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"≤","label":"","value":3.9},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≤","label":"","value":6.9},{"id":2,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"≤","label":"","value":8.9},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≤","label":"","value":10}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["cloudType","state","hypervisorType","davis_assessment.level","event.status","process.name","vulnerable_component"],"categoryAxisLabel":"cloudType,state,hypervisorType,davis_assessment.level,event.status,process.name,vulnerable_component","valueAxis":["davis_assessment.score","cvss.base"],"valueAxisLabel":"davis_assessment.score,cvss.base","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":["davis_assessment.score","cvss.base"],"fieldMapping":{"timestamp":"lifetime","leftAxisValues":["davis_assessment.score"]},"xAxisLabel":"lifetime","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"timestamp","prefixIcon":"","recordField":"timestamp","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"davis_assessment.level\"]":165.453125,"[\"davis_assessment.score\"]":95.6875,"[\"vulnerability.references.cve\"]":278.9453125,"[\"description\"]":315.78125,"[\"ipAddress\"]":158},"columnTypeOverrides":[],"sortBy":{"columnId":"[\"macAddresses\"]","direction":"descending"}},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["cloudType","state","hypervisorType","davis_assessment.level","event.status","process.name","vulnerable_component"],"dataMappings":{"value":"davis_assessment.score"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"davis_assessment.score","rangeAxis":""},{"valueAxis":"cvss.base","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["cloudType","state","hypervisorType","davis_assessment.level","event.status","process.name","vulnerable_component"]},"valueBoundaries":{"min":"auto","max":"auto"},"label":{"showLabel":false,"label":"davis_assessment.score"},"icon":{"showIcon":false,"icon":""},"autoSelectVisualization":false,"recordView":{"fieldsWidth":200.84},"dataMapping":{"value":"davis_assessment.score"}},"querySettings":{"maxResultRecords":5000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":20,"defaultSamplingRatio":10,"enableSampling":false}},"3":{"type":"data","title":"Vulnerability analysis by Hypervisor","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, $CVE)\n| fieldsRename  dt.source_entity = affected_entity.id\n| expand related_entities.hosts.ids\n| dedup {vulnerability.id, dt.source_entity}\n// You can join these records using Dynatrace's InnerJoin\n| join [\nfetch dt.entity.host\n| fieldsAdd ipAddress, entity.name, host_tags=tags, cloudType, macAddresses, state, hypervisorType, lifetime\n], on: { left[related_entities.hosts.ids] == right[id]}, fields: {ipAddress, entity.name, host_tags, cloudType, macAddresses, state, hypervisorType, lifetime} \n\n| fields CVE=vulnerability.references.cve,\n    davis_assessment.level=vulnerability.davis_assessment.level,\n    event.status,\n    davis_assessment.score=vulnerability.davis_assessment.score,\n    cvss.base=vulnerability.cvss.base_score,\n    process.name=affected_entity.name, \n    hosts.names=related_entities.hosts.names,\n    ipAddress,\n    host_tags, cloudType, macAddresses, state, hypervisorType, lifetime,\n    vulnerable_component=affected_entity.vulnerable_component.name,\n    technology=vulnerability.technology \n   \n| summarize count=count(), by: {hypervisorType}\n","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"categoricalBarChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["hypervisorType"],"categoryAxisLabel":"hypervisorType","valueAxis":["count"],"valueAxisLabel":"count","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":["davis_assessment.score","cvss.base","count"],"xAxisLabel":"lifetime","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"timestamp","prefixIcon":"","recordField":"timestamp","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"davis_assessment.level\"]":165.453125,"[\"davis_assessment.score\"]":95.6875,"[\"vulnerability.references.cve\"]":278.9453125,"[\"description\"]":315.78125},"columnTypeOverrides":[],"sortBy":{"columnId":"[\"davis_assessment.score\"]","direction":"descending"}},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["hypervisorType"],"dataMappings":{"value":"count"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["hypervisorType"]},"valueBoundaries":{"min":"auto","max":"auto"},"label":{"showLabel":false,"label":"count"},"icon":{"showIcon":false,"icon":""},"autoSelectVisualization":false,"recordView":{"fieldsWidth":200.84},"dataMapping":{"value":"count"}},"querySettings":{"maxResultRecords":5000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":20,"defaultSamplingRatio":10,"enableSampling":false}},"4":{"type":"data","title":"Vulnerability analysis by Cloud Type","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, $CVE)\n| fieldsRename  dt.source_entity = affected_entity.id\n| expand related_entities.hosts.ids\n| dedup {vulnerability.id, dt.source_entity}\n// You can join these records using Dynatrace's InnerJoin\n| join [\nfetch dt.entity.host\n| fieldsAdd ipAddress, entity.name, host_tags=tags, cloudType, macAddresses, state, hypervisorType, lifetime\n], on: { left[related_entities.hosts.ids] == right[id]}, fields: {ipAddress, entity.name, host_tags, cloudType, macAddresses, state, hypervisorType, lifetime} \n\n| fields CVE=vulnerability.references.cve,\n    davis_assessment.level=vulnerability.davis_assessment.level,\n    event.status,\n    davis_assessment.score=vulnerability.davis_assessment.score,\n    cvss.base=vulnerability.cvss.base_score,\n    process.name=affected_entity.name, \n    hosts.names=related_entities.hosts.names,\n    ipAddress,\n    host_tags, cloudType, macAddresses, state, hypervisorType, lifetime,\n    vulnerable_component=affected_entity.vulnerable_component.name,\n    technology=vulnerability.technology \n   \n| summarize count=count(), by: {cloudType}\n","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"pieChart","visualizationSettings":{"thresholds":[{"id":1,"field":"davis_assessment.level","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"=","label":"","value":"LOW"},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"=","label":"","value":"MEDIUM"},{"id":2,"color":{"Default":"var(--dt-colors-charts-status-critical-default, #c4233b)"},"comparator":"=","label":"","value":"CRITICAL"},{"id":3,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"=","label":"","value":"HIGH"}]},{"id":2,"field":"davis_assessment.score","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"≤","label":"","value":3.9},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≤","label":"","value":6.9},{"id":2,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"≤","label":"","value":8.9},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≤","label":"","value":10}]},{"id":3,"field":"cvss.base","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"≤","label":"","value":3.9},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≤","label":"","value":6.9},{"id":2,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"≤","label":"","value":8.9},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≤","label":"","value":10}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["cloudType"],"categoryAxisLabel":"cloudType","valueAxis":["count"],"valueAxisLabel":"count","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":["davis_assessment.score","cvss.base"],"xAxisLabel":"lifetime","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"timestamp","prefixIcon":"","recordField":"timestamp","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"davis_assessment.level\"]":165.453125,"[\"davis_assessment.score\"]":95.6875,"[\"vulnerability.references.cve\"]":278.9453125,"[\"description\"]":315.78125},"columnTypeOverrides":[],"sortBy":{"columnId":"[\"davis_assessment.score\"]","direction":"descending"}},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["cloudType"],"dataMappings":{"value":"count"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["cloudType"]},"valueBoundaries":{"min":"auto","max":"auto"},"label":{"showLabel":false,"label":"count"},"icon":{"showIcon":false,"icon":""},"autoSelectVisualization":false,"recordView":{"fieldsWidth":200.84},"dataMapping":{"value":"count"}},"querySettings":{"maxResultRecords":5000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":20,"defaultSamplingRatio":10,"enableSampling":false}},"5":{"type":"data","title":"Vulnerability Analysis - Process Groups","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, $CVE)\n| summarize max_davis_score=max(vulnerability.davis_assessment.score)\n\n","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"max_davis_score","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"<","label":"","value":3.9},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≤","label":"","value":6.9},{"id":2,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"≤","label":"","value":8.9},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≤","label":"","value":10}]},{"id":2,"field":"davis_assessment.score","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"≤","label":"","value":3.9},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≤","label":"","value":6.9},{"id":2,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"≤","label":"","value":8.9},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≤","label":"","value":10}]},{"id":3,"field":"cvss.base","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"≤","label":"","value":3.9},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≤","label":"","value":6.9},{"id":2,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"≤","label":"","value":8.9},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≤","label":"","value":10}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["max_davis_score"],"categoryAxisLabel":"max_davis_score","valueAxis":["max_davis_score"],"valueAxisLabel":"max_davis_score","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":[]},"singleValue":{"showLabel":true,"label":"Max Davis Score","prefixIcon":"","recordField":"max_davis_score","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"davis_assessment.level\"]":165.453125,"[\"davis_assessment.score\"]":95.6875,"[\"vulnerability.references.cve\"]":278.9453125,"[\"description\"]":315.78125},"columnTypeOverrides":[],"sortBy":{"columnId":"[\"davis_assessment.score\"]","direction":"descending"}},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":[],"dataMappings":{},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"max_davis_score","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":[]},"label":{"showLabel":false,"label":"max_davis_score"},"icon":{"showIcon":false,"icon":""},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"recordView":{"fieldsWidth":200.84},"dataMapping":{"value":"max_davis_score"}},"querySettings":{"maxResultRecords":5000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":20,"defaultSamplingRatio":10,"enableSampling":false}},"12":{"type":"data","title":"Process Group - Network Exposure","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, $CVE)\n| fieldsRename  dt.source_entity = affected_entity.id\n| dedup vulnerability.id,dt.source_entity, sort:{timestamp desc}\n| summarize count = count(), by:{vulnerability.davis_assessment.exposure_status}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"categoricalBarChart","visualizationSettings":{"autoSelectVisualization":false,"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["vulnerability.davis_assessment.exposure_status"],"categoryAxisLabel":"vulnerability.davis_assessment.exposure_status","valueAxis":["count"],"valueAxisLabel":"count","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":["interval","Open vulnerabilities","affected_entity.reachable_data_assets.count","related_entities.applications.count","related_entities.databases.count","related_entities.hosts.count","related_entities.kubernetes_clusters.count","related_entities.kubernetes_workloads.count","related_entities.services.count","vulnerability.cvss.base_score","vulnerability.davis_assessment.score","vulnerability.parent.davis_assessment.score","vulnerability.parent.risk.score","vulnerability.risk.score"],"xAxisLabel":"timestamp","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":false,"label":"Open vulnerabilities","prefixIcon":"PublicExposureIcon","recordField":"Open vulnerabilities","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true,"upward":"#D65151","downward":"#48936F"},"colorThresholdTarget":"value","isIconVisible":true,"sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["vulnerability.davis_assessment.exposure_status"],"dataMappings":{"value":"count"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["vulnerability.davis_assessment.exposure_status"]},"valueBoundaries":{"min":"auto","max":"auto"},"label":{"showLabel":false,"label":"count"},"icon":{"showIcon":false,"icon":""},"dataMapping":{"value":"count"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"13":{"type":"data","title":"Process Group - Data Asset Access","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, $CVE)\n| fieldsRename  dt.source_entity = affected_entity.id\n| dedup vulnerability.id,dt.source_entity, sort:{timestamp desc}\n| summarize count = count(), by:{vulnerability.davis_assessment.data_assets_status}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"categoricalBarChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["vulnerability.davis_assessment.data_assets_status"],"categoryAxisLabel":"vulnerability.davis_assessment.data_assets_status","valueAxis":["count"],"valueAxisLabel":"count","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":["interval","Open vulnerabilities","affected_entity.reachable_data_assets.count","related_entities.applications.count","related_entities.databases.count","related_entities.hosts.count","related_entities.kubernetes_clusters.count","related_entities.kubernetes_workloads.count","related_entities.services.count","vulnerability.cvss.base_score","vulnerability.davis_assessment.score","vulnerability.parent.davis_assessment.score","vulnerability.parent.risk.score","vulnerability.risk.score"],"xAxisLabel":"timestamp","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":false,"label":"Open vulnerabilities","prefixIcon":"PublicExposureIcon","recordField":"Open vulnerabilities","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true,"upward":"#D65151","downward":"#48936F"},"colorThresholdTarget":"value","isIconVisible":true,"sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["vulnerability.davis_assessment.data_assets_status"],"dataMappings":{"value":"count"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["vulnerability.davis_assessment.data_assets_status"]},"valueBoundaries":{"min":"auto","max":"auto"},"label":{"showLabel":false,"label":"count"},"icon":{"showIcon":false,"icon":""},"autoSelectVisualization":false,"dataMapping":{"value":"count"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"14":{"type":"data","title":"Vulnerability Analysis - Process Groups","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, $CVE)\n| summarize max(vulnerability.cvss.base_score)\n// | fields \n//     vulnerability.id,\n//     CVE=vulnerability.references.cve,\n//     davis_assessment.level=vulnerability.davis_assessment.level,\n//     event.status,\n//     davis_assessment.score=vulnerability.davis_assessment.score,\n//     cvss.base=vulnerability.cvss.base_score,\n//     description=event.description, \n//     process.name=affected_entity.name, \n//     pg.name, \n//     path,\n//     listenPorts, \n//     hosts.names=related_entities.hosts.names, \n//     vulnerable_component=affected_entity.vulnerable_component.name,\n//     technology=vulnerability.technology,\n//     stack=vulnerability.stack,\n//     remediation=vulnerability.remediation.description,\n//     tags,\n//     vulnerability.url,\n//     vulnerability.external_url,\n//     exposure_status=vulnerability.davis_assessment.exposure_status,\n//     data_assets_status=vulnerability.davis_assessment.data_assets_status,\n//     vulnerable_function_status=vulnerability.davis_assessment.vulnerable_function_status,\n//     exploit_status=vulnerability.davis_assessment.exploit_status\n","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"max(vulnerability.cvss.base_score)","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"<","label":"","value":3.9},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≤","label":"","value":6.9},{"id":2,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"≤","label":"","value":8.9},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≤","label":"","value":10}]},{"id":2,"field":"davis_assessment.score","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"≤","label":"","value":3.9},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≤","label":"","value":6.9},{"id":2,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"≤","label":"","value":8.9},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≤","label":"","value":10}]},{"id":3,"field":"cvss.base","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"≤","label":"","value":3.9},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"≤","label":"","value":6.9},{"id":2,"color":{"Default":"var(--dt-colors-charts-security-risk-level-high-default, #cd3741)"},"comparator":"≤","label":"","value":8.9},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-emergency-default, #ae132d)"},"comparator":"≤","label":"","value":10}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["max(vulnerability.cvss.base_score)"],"categoryAxisLabel":"max(vulnerability.cvss.base_score)","valueAxis":["max(vulnerability.cvss.base_score)"],"valueAxisLabel":"max(vulnerability.cvss.base_score)","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":[]},"singleValue":{"showLabel":true,"label":"CVSS Base Score","prefixIcon":"","recordField":"max(vulnerability.cvss.base_score)","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"davis_assessment.level\"]":165.453125,"[\"davis_assessment.score\"]":95.6875,"[\"vulnerability.references.cve\"]":278.9453125,"[\"description\"]":315.78125},"columnTypeOverrides":[],"sortBy":{"columnId":"[\"davis_assessment.score\"]","direction":"descending"}},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":[],"dataMappings":{},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"max(vulnerability.cvss.base_score)","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":[]},"label":{"showLabel":false,"label":"max(vulnerability.cvss.base_score)"},"icon":{"showIcon":false,"icon":""},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"recordView":{"fieldsWidth":200.84},"dataMapping":{"value":"max(vulnerability.cvss.base_score)"}},"querySettings":{"maxResultRecords":5000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":20,"defaultSamplingRatio":10,"enableSampling":false}},"15":{"type":"data","title":"Exploit Published","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, \"CVE-2019-0221\")\n| fieldsRename  dt.source_entity = affected_entity.id\n| dedup vulnerability.id,dt.source_entity, sort:{timestamp desc}\n| limit 1\n| fields vulnerability.davis_assessment.exploit_status","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["vulnerability.davis_assessment.exploit_status"],"categoryAxisLabel":"vulnerability.davis_assessment.exploit_status","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":["interval","Open vulnerabilities","affected_entity.reachable_data_assets.count","related_entities.applications.count","related_entities.databases.count","related_entities.hosts.count","related_entities.kubernetes_clusters.count","related_entities.kubernetes_workloads.count","related_entities.services.count","vulnerability.cvss.base_score","vulnerability.davis_assessment.score","vulnerability.parent.davis_assessment.score","vulnerability.parent.risk.score","vulnerability.risk.score"],"xAxisLabel":"timestamp","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":false,"label":"Open vulnerabilities","prefixIcon":"ExploitIcon","recordField":"vulnerability.davis_assessment.exploit_status","autoscale":true,"alignment":"center","trend":{"trendType":"auto","upward":"#D65151","downward":"#48936F","isVisible":true},"colorThresholdTarget":"value","isIconVisible":true,"sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":[],"dataMappings":{},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle","displayedFields":["vulnerability.davis_assessment.exploit_status"]},"label":{"showLabel":false},"icon":{"showIcon":false,"icon":""},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"dataMapping":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"16":{"type":"data","title":"Process Group - Vulnerable Functions in Use","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, $CVE)\n| fieldsRename  dt.source_entity = affected_entity.id\n| dedup vulnerability.id,dt.source_entity, sort:{timestamp desc}\n| summarize count = count(), by:{vulnerability.davis_assessment.vulnerable_function_status}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"categoricalBarChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["vulnerability.davis_assessment.vulnerable_function_status"],"categoryAxisLabel":"vulnerability.davis_assessment.vulnerable_function_status","valueAxis":["count"],"valueAxisLabel":"count","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":["interval","Open vulnerabilities","affected_entity.reachable_data_assets.count","related_entities.applications.count","related_entities.databases.count","related_entities.hosts.count","related_entities.kubernetes_clusters.count","related_entities.kubernetes_workloads.count","related_entities.services.count","vulnerability.cvss.base_score","vulnerability.davis_assessment.score","vulnerability.parent.davis_assessment.score","vulnerability.parent.risk.score","vulnerability.risk.score"],"xAxisLabel":"timestamp","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":false,"label":"Open vulnerabilities","prefixIcon":"PublicExposureIcon","recordField":"Open vulnerabilities","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true,"upward":"#D65151","downward":"#48936F"},"colorThresholdTarget":"value","isIconVisible":true,"sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["vulnerability.davis_assessment.vulnerable_function_status"],"dataMappings":{"value":"count"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["vulnerability.davis_assessment.vulnerable_function_status"]},"valueBoundaries":{"min":"auto","max":"auto"},"label":{"showLabel":false,"label":"count"},"icon":{"showIcon":false,"icon":""},"autoSelectVisualization":false,"dataMapping":{"value":"count"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"17":{"type":"data","title":"Process Group - Network Exposure","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, $CVE)\n| fieldsRename  dt.source_entity = affected_entity.id, \n  exposure_status = vulnerability.davis_assessment.exposure_status\n| dedup vulnerability.id,dt.source_entity, sort:{timestamp desc}\n| summarize count = count(), by:{exposure_status}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["exposure_status"],"categoryAxisLabel":"exposure_status","valueAxis":["count"],"valueAxisLabel":"count","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":["interval","Open vulnerabilities","affected_entity.reachable_data_assets.count","related_entities.applications.count","related_entities.databases.count","related_entities.hosts.count","related_entities.kubernetes_clusters.count","related_entities.kubernetes_workloads.count","related_entities.services.count","vulnerability.cvss.base_score","vulnerability.davis_assessment.score","vulnerability.parent.davis_assessment.score","vulnerability.parent.risk.score","vulnerability.risk.score"],"xAxisLabel":"timestamp","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":false,"label":"Open vulnerabilities","prefixIcon":"PublicExposureIcon","recordField":"Open vulnerabilities","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true,"upward":"#D65151","downward":"#48936F"},"colorThresholdTarget":"value","isIconVisible":true,"sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"vulnerability.davis_assessment.exposure_status\"]":354.2109375},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["vulnerability.davis_assessment.exposure_status"],"dataMappings":{"value":"count"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["exposure_status"]},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"label":{"showLabel":false,"label":"count"},"icon":{"showIcon":false,"icon":""},"dataMapping":{"value":"count"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"18":{"type":"data","title":"Process Group - Data Asset Access","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, $CVE)\n| fieldsRename  dt.source_entity = affected_entity.id,\n  data_assets_status = vulnerability.davis_assessment.data_assets_status\n| dedup vulnerability.id,dt.source_entity, sort:{timestamp desc}\n| summarize count = count(), by:{data_assets_status}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["data_assets_status"],"categoryAxisLabel":"data_assets_status","valueAxis":["count"],"valueAxisLabel":"count","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":["interval","Open vulnerabilities","affected_entity.reachable_data_assets.count","related_entities.applications.count","related_entities.databases.count","related_entities.hosts.count","related_entities.kubernetes_clusters.count","related_entities.kubernetes_workloads.count","related_entities.services.count","vulnerability.cvss.base_score","vulnerability.davis_assessment.score","vulnerability.parent.davis_assessment.score","vulnerability.parent.risk.score","vulnerability.risk.score"],"xAxisLabel":"timestamp","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":false,"label":"Open vulnerabilities","prefixIcon":"PublicExposureIcon","recordField":"Open vulnerabilities","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true,"upward":"#D65151","downward":"#48936F"},"colorThresholdTarget":"value","isIconVisible":true,"sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["vulnerability.davis_assessment.data_assets_status"],"dataMappings":{"value":"count"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["data_assets_status"]},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"label":{"showLabel":false,"label":"count"},"icon":{"showIcon":false,"icon":""},"dataMapping":{"value":"count"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"19":{"type":"data","title":"Process Group - Vulnerable Functions in Use","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\n| filter event.provider==\"Dynatrace\" // only events generated by dynatrace\n| filter event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\n| filter event.level==\"ENTITY\" // on entity level\n| filter vulnerability.mute.status == \"NOT_MUTED\"\n| filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| filter in(vulnerability.references.cve, $CVE)\n| fieldsRename  dt.source_entity = affected_entity.id,\n  vulnerable_function_status = vulnerability.davis_assessment.vulnerable_function_status\n| dedup vulnerability.id,dt.source_entity, sort:{timestamp desc}\n| summarize count = count(), by:{vulnerable_function_status}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["vulnerable_function_status"],"categoryAxisLabel":"vulnerable_function_status","valueAxis":["count"],"valueAxisLabel":"count","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":["interval","Open vulnerabilities","affected_entity.reachable_data_assets.count","related_entities.applications.count","related_entities.databases.count","related_entities.hosts.count","related_entities.kubernetes_clusters.count","related_entities.kubernetes_workloads.count","related_entities.services.count","vulnerability.cvss.base_score","vulnerability.davis_assessment.score","vulnerability.parent.davis_assessment.score","vulnerability.parent.risk.score","vulnerability.risk.score"],"xAxisLabel":"timestamp","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":false,"label":"Open vulnerabilities","prefixIcon":"PublicExposureIcon","recordField":"Open vulnerabilities","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true,"upward":"#D65151","downward":"#48936F"},"colorThresholdTarget":"value","isIconVisible":true,"sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"vulnerability.davis_assessment.vulnerable_function_status\"]":368.796875},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["vulnerability.davis_assessment.vulnerable_function_status"],"dataMappings":{"value":"count"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["vulnerable_function_status"]},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"label":{"showLabel":false,"label":"count"},"icon":{"showIcon":false,"icon":""},"dataMapping":{"value":"count"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},"layouts":{"0":{"x":0,"y":9,"w":24,"h":5},"2":{"x":0,"y":19,"w":24,"h":5},"3":{"x":6,"y":14,"w":18,"h":5},"4":{"x":0,"y":14,"w":6,"h":5},"5":{"x":0,"y":0,"w":3,"h":3},"12":{"x":3,"y":0,"w":13,"h":3},"13":{"x":3,"y":3,"w":13,"h":3},"14":{"x":0,"y":3,"w":3,"h":3},"15":{"x":0,"y":6,"w":3,"h":3},"16":{"x":3,"y":6,"w":13,"h":3},"17":{"x":16,"y":0,"w":8,"h":3},"18":{"x":16,"y":3,"w":8,"h":3},"19":{"x":16,"y":6,"w":8,"h":3}},"importedWithCode":false,"settings":{}}
