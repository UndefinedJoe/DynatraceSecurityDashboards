{"version":17,"variables":[],"tiles":{"1":{"title":"Trend of Vulnerabilities by Affected Entity (Process Groups)","type":"data","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\nAND event.provider==\"Dynatrace\" // only events generated by dynatrace\nAND event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n//| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\nAND event.level==\"ENTITY\" // on entity level\n// | filter vulnerability.mute.status == \"NOT_MUTED\"\n// | filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| expand vulnerability.references.cve\n| summarize\n{\n  // timestamp = takeFirst(timestamp),\n  vulnerability.stack=takeAny(vulnerability.stack),\n  cve = TakeFirst(vulnerability.references.cve),\n  davis_assessment = takeFirst(vulnerability.davis_assessment.level),\n  risk.score=takeMax(if(vulnerability.mute.status!=\"MUTED\",vulnerability.risk.score,else:0)),\n  namespaceName = takeFirst(namespaceName),\n  event.status = takeFirst(event.status),\n  vulnerability.resolution.status = takeFirst(vulnerability.resolution.status),\n  vulnerability.type=takeAny(vulnerability.type),\n  vulnerability.parent.first_seen = takeFirst(vulnerability.parent.first_seen),\n  vulnerability.parent.resolution.status=takeFirst(vulnerability.parent.resolution.status),\n  vulnerability.parent.mute.status=takeFirst(vulnerability.parent.mute.status)\n},by: {vulnerability.display_id, affected_entity.id, timestamp=bin(timestamp,1d)}\n| fieldsAdd age = now()-vulnerability.parent.first_seen\n\n| makeTimeseries {\n  Vulnerabilities=countIf(vulnerability.resolution.status==\"OPEN\", default:null)\n}, time: timestamp, interval:1d, by: {davis_assessment}\n","visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["davis_assessment"],"categoryAxisLabel":"davis_assessment","valueAxis":["interval"],"valueAxisLabel":"interval","tooltipVariant":"single"},"colorPalette":"security-risk-level","valueRepresentation":"absolute","truncationMode":"middle","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"hiddenLegendFields":["affected_entity","ResolvedVulnerabilities","affected_entity.reachable_data_assets.count","related_entities.applications.count","related_entities.databases.count","related_entities.hosts.count","related_entities.kubernetes_clusters.count","related_entities.kubernetes_workloads.count","related_entities.services.count","vulnerability.davis_assessment.score","vulnerability.parent.davis_assessment.score","vulnerability.parent.risk.score","vulnerability.risk.score","vulnerability.cvss.base_score","OpenVulnerabilities","Open","interval","Open vulnerabilities","age"],"leftYAxisSettings":{"isLabelVisible":false},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["Vulnerabilities"]},"legend":{"position":"auto","hidden":false},"seriesOverrides":[],"tooltip":{"seriesDisplayMode":"multi-line"}},"singleValue":{"showLabel":true,"label":"OpenVulnerabilities","prefixIcon":"","recordField":"OpenVulnerabilities","autoscale":true,"sparklineSettings":{},"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","isIconVisible":false},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[{"fields":["Vulnerabilities"],"value":"sparkline","id":1743354863324}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["davis_assessment"]},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"dataMapping":{"value":"OpenVulnerabilities"},"label":{"showLabel":true,"label":"OpenVulnerabilities"},"unitsOverrides":[{"identifier":null,"unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1743355581215}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"timeframe":{"tileTimeframe":{"from":"2025-03-15T21:44:54.401Z","to":"2025-03-27T09:55:26.121Z"},"tileTimeframeEnabled":false}},"2":{"title":"Resolved Vulnerable Entities by Davis Severity ","type":"data","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\nAND event.provider==\"Dynatrace\" // only events generated by dynatrace\nAND event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n//| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\nAND event.level==\"ENTITY\" // on entity level\n// | filter vulnerability.mute.status == \"NOT_MUTED\"\n// | filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| expand vulnerability.references.cve\n| summarize\n{\n  timestamp = takeFirst(timestamp),\n  vulnerability.stack=takeAny(vulnerability.stack),\n  cve = TakeFirst(vulnerability.references.cve),\n  davis = takeFirst(vulnerability.davis_assessment.level),\n  risk.score = takeMax(if(vulnerability.mute.status!=\"MUTED\",vulnerability.risk.score,else:0)),\n  namespaceName = takeFirst(namespaceName),\n  event.status = takeFirst(event.status),\n  vulnerability.resolution.status = takeFirst(vulnerability.resolution.status),\n  vulnerability.type=takeAny(vulnerability.type),\n  vulnerability.parent.first_seen = takeFirst(vulnerability.parent.first_seen),\n  vulnerability.parent.resolution.status=takeFirst(vulnerability.parent.resolution.status),\n  vulnerability.parent.mute.status=takeFirst(vulnerability.parent.mute.status),\n  exposure_status = takeFirst(vulnerability.davis_assessment.exposure_status),\n  data_assets_status = takeFirst(vulnerability.davis_assessment.data_assets_status),\n  vulnerable_function_status = takeFirst(vulnerability.davis_assessment.vulnerable_function_status),\n  exploit_status = takeFirst(vulnerability.davis_assessment.exploit_status)\n},by: {vulnerability.id, affected_entity.id}\n\n| fieldsAdd age = timestamp - vulnerability.parent.first_seen \n\n| summarize {\n  `Total Resolved` = countIf(vulnerability.resolution.status == \"RESOLVED\"),\n  `Resolved < 15d` = countIf(vulnerability.resolution.status == \"RESOLVED\" AND age < 15d),\n  `Resolved 15d-30d` = countIf(vulnerability.resolution.status == \"RESOLVED\" AND age >= 15d AND age < 30d),\n  `Resolved 30d-90d` = countIf(vulnerability.resolution.status == \"RESOLVED\" AND age >= 30d AND age <= 90d),\n  `Resolved > 90d` = countIf(vulnerability.resolution.status == \"RESOLVED\" AND age > 90d),\n  `Resolved Network Exposure` = countIf(vulnerability.resolution.status == \"RESOLVED\" AND exposure_status != \"NOT_AVAILABLE\" AND exposure_status != \"NOT_DETECTED\"),\n  `Resolved Data Assets` = countIf(vulnerability.resolution.status == \"RESOLVED\" AND data_assets_status == \"REACHABLE\"),\n  `Resolved Vuln Function` = countIf(vulnerability.resolution.status == \"RESOLVED\" AND vulnerable_function_status == \"IN_USE\"),\n  `Resolved Exploit Available` = countIf(vulnerability.resolution.status == \"RESOLVED\" AND exploit_status == \"AVAILABLE\")\n}, by: { davis}\n\n","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"davis","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"=","label":"","value":"LOW"},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"=","label":"","value":"MEDIUM"},{"id":2,"color":{"Default":"var(--dt-colors-charts-status-critical-default, #c4233b)"},"comparator":"=","label":"","value":"CRITICAL"},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-critical-default, #d85a9f)"},"comparator":"=","label":"","value":"HIGH"}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["davis"],"categoryAxisLabel":"davis","valueAxis":["Total Resolved","Resolved < 15d","Resolved 15d-30d","Resolved 30d-90d","Resolved > 90d","Resolved Network Exposure","Resolved Data Assets","Resolved Vuln Function","Resolved Exploit Available"],"valueAxisLabel":"Total Resolved,Resolved < 15d,Resolved 15d-30d,Resolved 30d-90d,Resolved > 90d,Resolved Network Exposure,Resolved Data Assets,Resolved Vuln Function,Resolved Exploit Available","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","xAxisLabel":"timestamp","xAxisIsLabelVisible":false,"hiddenLegendFields":["affected_entity","ResolvedVulnerabilities","affected_entity.reachable_data_assets.count","related_entities.applications.count","related_entities.databases.count","related_entities.hosts.count","related_entities.kubernetes_clusters.count","related_entities.kubernetes_workloads.count","related_entities.services.count","vulnerability.davis_assessment.score","vulnerability.parent.davis_assessment.score","vulnerability.parent.risk.score","vulnerability.risk.score","vulnerability.cvss.base_score","OpenVulnerabilities","Open","interval","Open vulnerabilities","age","risk.score"],"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"OpenVulnerabilities","prefixIcon":"","recordField":"OpenVulnerabilities","autoscale":true,"sparklineSettings":{},"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","isIconVisible":false},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Total Resolved","rangeAxis":""},{"valueAxis":"Resolved < 15d","rangeAxis":""},{"valueAxis":"Resolved 15d-30d","rangeAxis":""},{"valueAxis":"Resolved 30d-90d","rangeAxis":""},{"valueAxis":"Resolved > 90d","rangeAxis":""},{"valueAxis":"Resolved Network Exposure","rangeAxis":""},{"valueAxis":"Resolved Data Assets","rangeAxis":""},{"valueAxis":"Resolved Vuln Function","rangeAxis":""},{"valueAxis":"Resolved Exploit Available","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["davis"]},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"dataMapping":{"value":"OpenVulnerabilities"},"label":{"showLabel":true,"label":"OpenVulnerabilities"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"timeframe":{"tileTimeframe":{"from":"now()-30d","to":"now()"},"tileTimeframeEnabled":false}},"4":{"title":"Entities by Technology","type":"data","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\nAND event.provider==\"Dynatrace\" // only events generated by dynatrace\nAND event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n//| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\nAND event.level==\"ENTITY\" // on entity level\n// | filter vulnerability.mute.status == \"NOT_MUTED\"\n// | filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| expand vulnerability.references.cve\n| summarize\n{\n  timestamp = takeFirst(timestamp),\n  vulnerability.stack=takeAny(vulnerability.stack),\n  cve = TakeFirst(vulnerability.references.cve),\n  davis = takeFirst(vulnerability.davis_assessment.level),\n  risk.score = takeMax(if(vulnerability.mute.status!=\"MUTED\",vulnerability.risk.score,else:0)),\n  namespaceName = takeFirst(namespaceName),\n  event.status = takeFirst(event.status),\n  technology = takeFirst(vulnerability.technology),\n  vulnerability.resolution.status = takeFirst(vulnerability.resolution.status),\n  vulnerability.type=takeAny(vulnerability.type),\n  vulnerability.parent.first_seen = takeFirst(vulnerability.parent.first_seen),\n  vulnerability.parent.resolution.status=takeFirst(vulnerability.parent.resolution.status),\n  vulnerability.parent.mute.status=takeFirst(vulnerability.parent.mute.status),\n  exposure_status = takeFirst(vulnerability.davis_assessment.exposure_status),\n  data_assets_status = takeFirst(vulnerability.davis_assessment.data_assets_status),\n  vulnerable_function_status = takeFirst(vulnerability.davis_assessment.vulnerable_function_status),\n  exploit_status = takeFirst(vulnerability.davis_assessment.exploit_status)\n},by: {vulnerability.id, affected_entity.id}\n\n| fieldsAdd age = timestamp - vulnerability.parent.first_seen \n\n| summarize {\n  `Total Resolved` = countIf(vulnerability.resolution.status == \"RESOLVED\"),\n  `Resolved < 15d` = countIf(vulnerability.resolution.status == \"RESOLVED\" AND age < 15d),\n  `Resolved 15d-30d` = countIf(vulnerability.resolution.status == \"RESOLVED\" AND age >= 15d AND age < 30d),\n  `Resolved 30d-90d` = countIf(vulnerability.resolution.status == \"RESOLVED\" AND age >= 30d AND age <= 90d),\n  `Resolved > 90d` = countIf(vulnerability.resolution.status == \"RESOLVED\" AND age > 90d),\n  `Total Open` = countIf(vulnerability.resolution.status == \"OPEN\"),\n  `Open Network Exposure` = countIf(vulnerability.resolution.status == \"OPEN\" AND exposure_status != \"NOT_AVAILABLE\" AND exposure_status != \"NOT_DETECTED\"),\n  `Open Data Assets` = countIf(vulnerability.resolution.status == \"OPEN\" AND data_assets_status == \"REACHABLE\"),\n  `Open Vuln Function` = countIf(vulnerability.resolution.status == \"OPEN\" AND vulnerable_function_status == \"IN_USE\"),\n  `Open Exploit Available` = countIf(vulnerability.resolution.status == \"OPEN\" AND exploit_status == \"AVAILABLE\")\n}, by: { technology }\n\n","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"davis","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"=","label":"","value":"LOW"},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"=","label":"","value":"MEDIUM"},{"id":2,"color":{"Default":"var(--dt-colors-charts-status-critical-default, #c4233b)"},"comparator":"=","label":"","value":"CRITICAL"},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-critical-default, #d85a9f)"},"comparator":"=","label":"","value":"HIGH"}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["technology"],"categoryAxisLabel":"technology","valueAxis":["Total Resolved","Resolved < 15d","Resolved 15d-30d","Resolved 30d-90d","Resolved > 90d","Total Open","Open Network Exposure","Open Data Assets","Open Vuln Function","Open Exploit Available"],"valueAxisLabel":"Total Resolved,Resolved < 15d,Resolved 15d-30d,Resolved 30d-90d,Resolved > 90d,Total Open,Open Network Exposure,Open Data Assets,Open Vuln Function,Open Exploit Available","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","xAxisLabel":"timestamp","xAxisIsLabelVisible":false,"hiddenLegendFields":["affected_entity","ResolvedVulnerabilities","affected_entity.reachable_data_assets.count","related_entities.applications.count","related_entities.databases.count","related_entities.hosts.count","related_entities.kubernetes_clusters.count","related_entities.kubernetes_workloads.count","related_entities.services.count","vulnerability.davis_assessment.score","vulnerability.parent.davis_assessment.score","vulnerability.parent.risk.score","vulnerability.risk.score","vulnerability.cvss.base_score","OpenVulnerabilities","Open","interval","Open vulnerabilities","age","risk.score"],"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"OpenVulnerabilities","prefixIcon":"","recordField":"OpenVulnerabilities","autoscale":true,"sparklineSettings":{},"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","isIconVisible":false},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Total Resolved","rangeAxis":""},{"valueAxis":"Resolved < 15d","rangeAxis":""},{"valueAxis":"Resolved 15d-30d","rangeAxis":""},{"valueAxis":"Resolved 30d-90d","rangeAxis":""},{"valueAxis":"Resolved > 90d","rangeAxis":""},{"valueAxis":"Total Open","rangeAxis":""},{"valueAxis":"Open Network Exposure","rangeAxis":""},{"valueAxis":"Open Data Assets","rangeAxis":""},{"valueAxis":"Open Vuln Function","rangeAxis":""},{"valueAxis":"Open Exploit Available","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["technology"]},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"dataMapping":{"value":"OpenVulnerabilities"},"label":{"showLabel":true,"label":"OpenVulnerabilities"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"timeframe":{"tileTimeframe":{"from":"now()-30d","to":"now()"},"tileTimeframeEnabled":false}},"5":{"title":"Open Vulnerable Entities by Davis Severity ","type":"data","query":"fetch events\n| filter dt.system.bucket==\"default_security_events\" // only security events\nAND event.provider==\"Dynatrace\" // only events generated by dynatrace\nAND event.type==\"VULNERABILITY_STATE_REPORT_EVENT\" // historical vulnerability data\n//| filter vulnerability.stack == \"CODE_LIBRARY\" OR vulnerability.stack == \"SOFTWARE\"\nAND event.level==\"ENTITY\" // on entity level\n// | filter vulnerability.mute.status == \"NOT_MUTED\"\n// | filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n| expand vulnerability.references.cve\n| summarize\n{\n  timestamp = takeFirst(timestamp),\n  vulnerability.stack=takeAny(vulnerability.stack),\n  cve = TakeFirst(vulnerability.references.cve),\n  davis = takeFirst(vulnerability.davis_assessment.level),\n  risk.score = takeMax(if(vulnerability.mute.status!=\"MUTED\",vulnerability.risk.score,else:0)),\n  namespaceName = takeFirst(namespaceName),\n  event.status = takeFirst(event.status),\n  vulnerability.resolution.status = takeFirst(vulnerability.resolution.status),\n  vulnerability.type=takeAny(vulnerability.type),\n  vulnerability.parent.first_seen = takeFirst(vulnerability.parent.first_seen),\n  vulnerability.parent.resolution.status=takeFirst(vulnerability.parent.resolution.status),\n  vulnerability.parent.mute.status=takeFirst(vulnerability.parent.mute.status),\n  exposure_status = takeFirst(vulnerability.davis_assessment.exposure_status),\n  data_assets_status = takeFirst(vulnerability.davis_assessment.data_assets_status),\n  vulnerable_function_status = takeFirst(vulnerability.davis_assessment.vulnerable_function_status),\n  exploit_status = takeFirst(vulnerability.davis_assessment.exploit_status)\n},by: {vulnerability.id, affected_entity.id}\n\n| fieldsAdd age = timestamp - vulnerability.parent.first_seen \n\n| summarize {\n  `Total Open` = countIf(vulnerability.resolution.status == \"OPEN\"),\n  `Open < 15d` = countIf(vulnerability.resolution.status == \"OPEN\" AND age < 15d),\n  `Open 15d-30d` = countIf(vulnerability.resolution.status == \"OPEN\" AND age >= 15d AND age < 30d),\n  `Open 30d-90d` = countIf(vulnerability.resolution.status == \"OPEN\" AND age >= 30d AND age <= 90d),\n  `Open > 90d` = countIf(vulnerability.resolution.status == \"OPEN\" AND age > 90d),\n  \n  `Open Network Exposure` = countIf(vulnerability.resolution.status == \"OPEN\" AND exposure_status != \"NOT_AVAILABLE\" AND exposure_status != \"NOT_DETECTED\"),\n  `Open Data Assets` = countIf(vulnerability.resolution.status == \"OPEN\" AND data_assets_status == \"REACHABLE\"),\n  `Open Vuln Function` = countIf(vulnerability.resolution.status == \"OPEN\" AND vulnerable_function_status == \"IN_USE\"),\n  `Open Exploit Available` = countIf(vulnerability.resolution.status == \"OPEN\" AND exploit_status == \"AVAILABLE\")\n}, by: { davis}\n\n","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"davis","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-01-default, #134fc9)"},"comparator":"=","label":"","value":"LOW"},{"id":1,"color":{"Default":"var(--dt-colors-charts-status-warning-default, #eca440)"},"comparator":"=","label":"","value":"MEDIUM"},{"id":2,"color":{"Default":"var(--dt-colors-charts-status-critical-default, #c4233b)"},"comparator":"=","label":"","value":"CRITICAL"},{"id":3,"color":{"Default":"var(--dt-colors-charts-loglevel-critical-default, #d85a9f)"},"comparator":"=","label":"","value":"HIGH"}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["davis"],"categoryAxisLabel":"davis","valueAxis":["Total Open","Open < 15d","Open 15d-30d","Open 30d-90d","Open > 90d","Open Network Exposure","Open Data Assets","Open Vuln Function","Open Exploit Available"],"valueAxisLabel":"Total Open,Open < 15d,Open 15d-30d,Open 30d-90d,Open > 90d,Open Network Exposure,Open Data Assets,Open Vuln Function,Open Exploit Available","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","xAxisLabel":"timestamp","xAxisIsLabelVisible":false,"hiddenLegendFields":["affected_entity","ResolvedVulnerabilities","affected_entity.reachable_data_assets.count","related_entities.applications.count","related_entities.databases.count","related_entities.hosts.count","related_entities.kubernetes_clusters.count","related_entities.kubernetes_workloads.count","related_entities.services.count","vulnerability.davis_assessment.score","vulnerability.parent.davis_assessment.score","vulnerability.parent.risk.score","vulnerability.risk.score","vulnerability.cvss.base_score","OpenVulnerabilities","Open","interval","Open vulnerabilities","age","risk.score"],"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"OpenVulnerabilities","prefixIcon":"","recordField":"OpenVulnerabilities","autoscale":true,"sparklineSettings":{},"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","isIconVisible":false},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"Total Open\"]":149.140625,"[\"Open < 15d\"]":141.15625,"[\"Open 15d-30d\"]":161.078125,"[\"Open 30d-90d\"]":174.078125,"[\"Open > 90d\"]":130.15625,"[\"Open Network Exposure\"]":235.921875,"[\"Open Data Assets\"]":181.28125,"[\"Open Vuln Function\"]":200.171875},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Total Open","rangeAxis":""},{"valueAxis":"Open < 15d","rangeAxis":""},{"valueAxis":"Open 15d-30d","rangeAxis":""},{"valueAxis":"Open 30d-90d","rangeAxis":""},{"valueAxis":"Open > 90d","rangeAxis":""},{"valueAxis":"Open Network Exposure","rangeAxis":""},{"valueAxis":"Open Data Assets","rangeAxis":""},{"valueAxis":"Open Vuln Function","rangeAxis":""},{"valueAxis":"Open Exploit Available","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["davis"]},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"dataMapping":{"value":"OpenVulnerabilities"},"label":{"showLabel":true,"label":"OpenVulnerabilities"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"timeframe":{"tileTimeframe":{"from":"now()-30d","to":"now()"},"tileTimeframeEnabled":false}}},"layouts":{"1":{"x":0,"y":0,"w":24,"h":6},"2":{"x":0,"y":6,"w":24,"h":4},"4":{"x":0,"y":14,"w":24,"h":5},"5":{"x":0,"y":10,"w":24,"h":4}},"importedWithCode":false,"settings":{"defaultTimeframe":{"value":{"from":"now()-90d","to":"now()"},"enabled":true}}}